# Starter pipeline
# Start with a minimal pipeline that you can customize to build and deploy your code.
# Add steps that build, run tests, deploy, and more:
# https://aka.ms/yaml

parameters:
- name: token
  displayName: Stark token
  type: string
  default: ''

trigger:
- none

pool:
  vmImage: ubuntu-latest

steps:
- script: |
    npm i
    npm run dev &
  displayName: "Build and run server"
- task: StarkAccessibilityAudit@0
  env:
    STARK_REPORT_URL: https://dh-stark.ngrok.dev/api/cli-webhooks/url-scan-result/:scanId
    STARK_DETAILS_URL: https://dh-stark.ngrok.dev/api/cli-webhooks/scan-details/:scanId
    STARK_COMPLETION_URL: https://dh-stark.ngrok.dev/api/cli-webhooks/end-scan/:scanId
  inputs:
    token: '${{ parameters.token }}'
    waitTime: 5000
    urls: |
      http://localhost:3000